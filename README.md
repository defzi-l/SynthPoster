---
title: SynthPoster
emoji: 🎨
colorFrom: blue
colorTo: green
sdk: gradio
sdk_version: 5.44.0
app_file: app.py
python_version: "3.10"
pinned: false
---

---

# 🎨 SynthPoster - 智能海报创作协同系统

## 项目简介
SynthPoster 是一个基于智能体（Agent）协同工作流的AI海报生成系统。它通过三个专长不同的AI智能体（创意拆解 → 提示词优化 → 海报设计）接力协作，将一句简单的活动描述（如“AI模型协同讲座”）自动转化为一张风格化、信息完整的**中文校园活动海报**图像。

Live Demo: https://huggingface.co/spaces/Y-ris/SynthPoster

## 技术栈
- **后端框架**: LangChain
- **大语言模型 (LLM)**: 通义千问 `qwen-max` (通过兼容OpenAI API调用)
- **图像生成模型**: 通义千问 `qwen-image-plus`
- **Web界面**: Gradio
- **部署平台**: Hugging Face Spaces / 本地

## 安装与运行
1. **克隆仓库**
   ```bash
   git clone https://github.com/defzi-l/SynthPoster.git
   cd SynthPoster
   ```

2. **安装依赖**

   本地：

   ```bash
   pip install -r requirements.txt
   ```
   Hugging Face Spaces中会自动按照requirements.txt文件安装依赖。

3. **配置环境变量**

   本地：

   在项目根目录创建 `.env` 文件，填入你的API密钥：

   ```ini
   LLM_API_KEY=your_qwen_api_key_here
   LLM_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1（北京或和新加坡服务url不同）
   LLM_MODEL_NAME=qwen-max
   ```
   > **重要**: 请确保已在阿里云百炼平台开通并获取了 `qwen-max` 和 `qwen-image-plus` 模型的API Key。

   Space：

   打开Settings，找到Variables and secrets并添加。

4. **启动应用**

   本地：

   ```bash
   python app.py
   ```
   Space：

   上传文件后自动构建并发布启动。第一次启动时需要在Build阶段下载依赖，需要等待较长时间。

   > 重要：在Space中运行需要完整包含README文件的开头配置部分，可以参考此文件或创建Space时自动生成的README。

## 智能体协同工作流
系统核心是由三个 LangChain 智能体构成的标准化流水线：

1.  **智能体1 - 创意拆解师**
    *   **职责**：理解用户模糊的描述，提取核心主题、视觉元素和氛围。
    *   **输入**：用户原始描述（中文）。
    *   **输出**：结构化的元素列表。

2.  **智能体2 - 提示词优化师**
    *   **职责**：将结构化的中文元素转化为专业、详细的**英文**AI绘画提示词。
    *   **输入**：智能体1的输出。
    *   **输出**：高质量的英文图像描述。

3.  **智能体3 - 海报设计师**
    *   **职责**：综合原始描述和海报需求，生成**专为Qwen-Image优化**的最终提示词。它负责：
        *   补全活动**时间、地点**等关键信息。
        *   决定海报**版式**（竖版/方形/横版）。
        *   注入随机**艺术风格**（赛博朋克、复古、波普艺术等）。
        *   加入**中文文字精确性指令**，优化字体和排版要求。
    *   **输入**：用户原始描述。
    *   **输出**：中英混合、包含具体中文文字和版式指令的最终提示词。

## 🌿 项目分支说明
本仓库包含以下几个主要分支，反映了项目的迭代路径：

| 分支名称                        | 主要特点与目的                                               | 状态与备注                                                   |
| :------------------------------ | :----------------------------------------------------------- | :----------------------------------------------------------- |
| **`main`**                      | **稳定可用版本**。当前分支，集成了 `qwen-max` (LLM) 和 `qwen-image-plus` (生图) 的完整工作流。 | **生产环境推荐**。功能完整，提示词经过优化，界面简洁。       |
| **`with_network_and_api_test`** | **开发调试版本**。在 `main` 分支基础上，额外集成了网络诊断和API连通性测试功能。 | **供开发者使用**。帮助快速验证API配置和网络环境，功能稳定，界面包含调试面板。 |
| **`feat/llm-qwen-sd-local`**    | **实验与低成本版本**。使用 `qwen-max` (LLM) + `stabilityai/sd-turbo` (生图) 的架构。 | **存档/实验分支**。利用Hugging Face免费推理API节省资源，但生成效果和质量显著低于 `qwen-image-plus`。**提示词未针对SD模型优化，且保留网络测试代码。** |

## 已知问题与未来展望

### 1. 海报文字生成错误
-   **现象**：生成的图片中，特定中文文字（如“同”、“生”）偶尔会出现错字、错词。
-   **原因**：当前AI文生图模型的通病，将文字作为视觉纹理处理，而非精确的字符渲染。
-   **潜在解决方案**：
    *   接入 **`qwen-image-edit` (图生图) API**，对生成的海报进行局部文字修正。
    *   集成 **OCR (光学字符识别) 检测**，在生成后自动校验文字准确性，并提供重绘选项。

### 2. 提示词迭代与随机性
-   **智能体协同**：当前**智能体3（海报设计师）主要依据用户原始输入工作，未充分利用智能体1和2的中间输出结果**，导致信息流存在割裂，未能完全发挥协同潜力。可能会在后续修复这一逻辑断层。
-   **结果多样性**：尽管在提示词中加入了随机风格选择，**相同输入下的输出变化（随机性）依然有限**。
-   **优化方向**：
    *   重构工作流，让智能体3能更综合地参考前两个智能体的分析结果。

## 部署教程指南

如果你想快速了解如何从零开始，将本项目**部署到Hugging Face Space**，并配置所有环境，可以参考博文：

**《零成本部署一个简单AI海报生成工具》**

- **链接**：https://blog.csdn.net/m0_47935753/article/details/155782666?spm=1011.2415.3001.5331
- **内容涵盖**：Space创建、文件上传、密钥配置、依赖管理、调试技巧以及常见问题。相比此文档，主要添加了比较详细的Space创建与使用教程。

> 注：该教程与本文档互为补充。本文档提供**技术架构与核心逻辑**，教程则侧重**具体的部署操作步骤**。
